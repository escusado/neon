"undefined"==typeof global&&(global=window),global.Interface=function(e,t){var n,r,i;return n=e&&t?e:this,r=e&&t?t:e?e:"interface"+Math.random().toString(),i=function(e){return e.isInterface=!0,e.name=r,n[r]=e,n[r]}},global.Module=function(e,t){var n,r,i,s;return n=e&&t?e:this,r=e&&t?t:e?e:"module"+Math.random().toString(),s={moduleName:r,prototype:{},__includedModules:[],include:function(e){var t;for(t in e)e.hasOwnProperty(t)&&"prototype"!==t&&"isModule"!==t&&"__includedModules"!==t&&"include"!==t&&"moduleName"!==t&&(s[t]=e[t]);if(e.hasOwnProperty("prototype")&&e.prototype)for(t in e.prototype)e.prototype.hasOwnProperty(t)&&(s.prototype[t]=e.prototype[t]);else e.prototype={};return this.__includedModules.push(e),this}},i=function(e){var t;s.isModule=!0;for(t in e)e.hasOwnProperty(t)&&"prototype"!==t&&"isModule"!==t&&"__includedModules"!==t&&"include"!==t&&"moduleName"!==t&&(s[t]=e[t]);if(e.hasOwnProperty("prototype")&&e.prototype)for(t in e.prototype)e.prototype.hasOwnProperty(t)&&(s.prototype[t]=e.prototype[t]);return n[r]=s,n[r]},i.includes=function(){for(var e=0;e<arguments.length;e++)s.include(arguments[e]);return i},i},global.Class=function(e,t){var n,r,i;return n=e&&t?e:global,t=e&&t?t:e?e:"class"+Math.random().toString(),r=function(){this.init&&this.init.apply(this,arguments)},r.__descendants=[],r.__implementedInterfaces=[],r.__includedModules=[],r.className=t,r.include=function(e){var t;for(t in e)e.hasOwnProperty(t)&&"prototype"!=t&&"constructor"!=t&&"isModule"!=t&&"superClass"!=t&&"include"!=t&&(r[t]=e[t]);if(e.hasOwnProperty("prototype")&&e.prototype)for(t in e.prototype)e.prototype.hasOwnProperty(t)&&(r.prototype[t]=e.prototype[t]);else e.prototype={};return r.__includedModules.push(e),this},i=function(e){var i,s,o,p,a,h=e.prototype;if(h){for(a in h)h.hasOwnProperty(a)&&(r.prototype[a]=h[a]);delete e.prototype}for(a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);for(i=0,s=r.__implementedInterfaces.length;s>i;i++){for(o=0,p=r.__implementedInterfaces[i].constructor.length;p>o;o++)if(!r[r.__implementedInterfaces[i].constructor[o]]){console.log("must implement static "+r.__implementedInterfaces[i].name);break}if(r.__implementedInterfaces[i].hasOwnProperty("prototype")&&r.__implementedInterfaces[i].prototype)for(o=0,p=r.__implementedInterfaces[i].prototype.length;p>o;o++)if(!r.prototype[r.__implementedInterfaces[i].prototype[o]]){console.log("must implement prototype "+r.__implementedInterfaces[i].name);break}}try{Li&&Li.ObjectSpy&&Li.Spy&&(r.__objectSpy=new Li.ObjectSpy,r.__objectSpy.spy(r),r.__objectSpy.spy(r.prototype))}catch(d){}return n[t]=r,r},i.inherits=function(e){var t,n;r.superClass=e,e.hasOwnProperty("__descendants")&&e.__descendants.push(r),n=function(){},n.prototype=e.prototype,r.prototype=new n,r.prototype.constructor=r;for(t in e)e.hasOwnProperty(t)&&"prototype"!=t&&"className"!==t&&"superClass"!==t&&"include"!==t&&"__descendants"!=t&&(r[t]=e[t]);return delete this.inherits,this},i.ensures=function(){for(var e=0;e<arguments.length;e++)r.__implementedInterfaces.push(arguments[e]);return delete this.ensures,i},i.includes=function(){for(var e=0;e<arguments.length;e++)r.include(arguments[e]);return i},i},Class("CustomEvent")({prototype:{bubbles:!0,cancelable:!0,currentTarget:null,timeStamp:0,target:null,type:"",isPropagationStopped:!1,isDefaultPrevented:!1,isImmediatePropagationStopped:!1,areImmediateHandlersPrevented:!1,init:function(e,t){if(this.type=e,"undefined"!=typeof t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])},stopPropagation:function(){this.isPropagationStopped=!0},preventDefault:function(){this.isDefaultPrevented=!0},stopImmediatePropagation:function(){this.preventImmediateHandlers(),this.stopPropagation()},preventImmediateHandlers:function(){this.areImmediateHandlersPrevented=!0}}}),Module("CustomEventSupport")({eventListeners:null,bind:function(e,t){var n,r,i;for(this.eventListeners||(this.eventListeners={}),this.eventListeners[e]||(this.eventListeners[e]=[]),n=!1,i=this.eventListeners[e],r=0;r<i.length;r++)if(i[r]===t){n=!0;break}return n||this.eventListeners[e].push(t),this},unbind:function(e,t){var n,r,i;for(r=!1,this.eventListeners||(this.eventListeners={}),"undefined"==typeof t&&(this.eventListeners[e]=[]),i=this.eventListeners[e],n=0;n<i.length;n++)if(i[n]===t){r=!0;break}return r&&this.eventListeners[e].splice(n,1),this},dispatch:function(e,t){var n,r,i,s;for(null===this.eventListeners&&(this.eventListeners={}),"undefined"==typeof t&&(t={}),t.hasOwnProperty("target")===!1&&(t.target=this),n=new CustomEvent(e,t),r=this.eventListeners[e]||[],i=this,s=0;s<r.length&&(r[s].call(i,n),n.areImmediateHandlersPrevented!==!0);s+=1);return n},prototype:{eventListeners:null,bind:function(e,t){var n,r,i;for(this.eventListeners||(this.eventListeners={}),this.eventListeners[e]||(this.eventListeners[e]=[]),n=!1,i=this.eventListeners[e],r=0;r<i.length;r++)if(i[r]===t){n=!0;break}return n||this.eventListeners[e].push(t),this},unbind:function(e,t){var n,r,i;for(r=!1,n=0,this.eventListeners||(this.eventListeners={}),"undefined"==typeof t&&(this.eventListeners[e]=[]),i=this.eventListeners[e],n=0;n<i.length;n++)if(i[n]==t){r=!0;break}return r&&this.eventListeners[e].splice(n,1),this},dispatch:function(e,t){var n,r,i,s;for(null===this.eventListeners&&(this.eventListeners={}),"undefined"==typeof t&&(t={}),t.hasOwnProperty("target")===!1&&(t.target=this),n=new CustomEvent(e,t),r=this.eventListeners[e]||[],i=this,s=0;s<r.length&&(r[s].call(i,n),n.areImmediateHandlersPrevented!==!0);s+=1);return n}}}),Module("NodeSupport")({prototype:{parent:null,children:[],appendChild:function(e){return e.parent&&e.parent.removeChild(e),this.hasOwnProperty("children")||(this.children=[]),this.children.push(e),this[e.name]=e,e.setParent(this),e},insertBefore:function(e,t){var n;return e.parent&&e.parent.removeChild(e),this.hasOwnProperty("children")||(this.children=[]),"undefined"==typeof t?this.appendChild(e):(n=this.children.indexOf(t),this.children.splice(n,0,e),this[e.name]=e,e.setParent(this)),e},insertChild:function(e,t){return console.warn("NodeSupport insertChild method is deprecated, try insertBefore"),e.parent&&e.parent.removeChild(e),this.hasOwnProperty("children")||(this.children=[]),"undefined"==typeof t?(this.children.push(e),this[e.name]=e,e.setParent(this),e):(this.children.splice(t,0,e),this[e.name]=e,e.setParent(this),e)},removeChild:function(e){var t=this.children.indexOf(e);return-1!==t&&(this.children.splice(t,1),delete this[e.name],e.parent=null),e},setParent:function(e){return this.parent=e,this},getDescendants:function(){var e=[];return this.children.forEach(function(t){e.push(t)}),this.children.forEach(function(t){e=e.concat(t.getDescendants())}),e},getPreviousSibling:function(){return"undefined"!=typeof this.parent&&this.parent.children[0]!==this?this.parent.children[this.parent.children.indexOf(this)-1]:void 0},getNextSibling:function(){return"undefined"!=typeof this.parent&&this.parent.children[this.parent.children.length-1]!==this?this.parent.children[this.parent.children.indexOf(this)+1]:void 0}}});